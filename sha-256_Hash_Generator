import hashlib
import pyfiglet
import time

# Pyfiglet Banner
ascii_banner = pyfiglet.figlet_format("SHA-256 Hash Generator", font = "slant")
print(ascii_banner)
print("This tool is for SHA-256 hashes only.")

# User input choice and exceptions
while True:
    hash_choice = str(input('Encode Hash or Decode Hash? Type E or D: ')).upper()
    if hash_choice == 'D':
        wordlist_location = str(input('Enter wordlist path: '))
        hash_input = str(input('Enter hash: '))

        time.sleep(1)
        print("Cracking...")
        time.sleep(2)
        print("Wordlist: ", wordlist_location)
        time.sleep(2)
        print("Target Hash: ", hash_input)
        time.sleep(2)
        print("Almost done...")
        time.sleep(2)

        try:
            with open(wordlist_location, 'r', encoding="utf-8", errors="ignore") as file:
                for line in file.readlines():
                    hash_ob = hashlib.sha256(line.strip().encode())
                    hashed_pass = hash_ob.hexdigest()
                    if hashed_pass == hash_input:
                        print('Found Password --> ' + line.strip())
                        break
                else:
                    print("Password not found")
                    continue

        except FileNotFoundError:
            print("Check file path or SHA256 hash")
        except PermissionError:
            print("Permission was denied.")

    elif hash_choice == 'E':
        user_hash = str(input('Enter text: '))
        hash_ob = hashlib.sha256(user_hash.encode())
        print(hash_ob.hexdigest())
    else:
        print("Invalid Choice")
        break









